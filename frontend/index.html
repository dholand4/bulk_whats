<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bulk Whatsapp</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="../../assets/icone.png" type="image/png" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="main-container">
        <div class="qr-section">
            <h2>Autentica√ß√£o</h2>

            <input type="text" id="matricula" placeholder="Digite sua matr√≠cula" required />
            <button onclick="authenticateWithMatricula()" style=" min-width: 200px">Autenticar</button>

            <img id="qrCode" style="display: none; margin-top: 20px;" alt="QR Code para login" />
            <p id="qrStatus" class="status-message">Clique para autenticar</p>

            <button id="clearAuthButton" style="display: none;" onclick="clearAuthentication()"
                aria-label="Limpar autentica√ß√£o">Limpar Autentica√ß√£o</button>
        </div>

        <div class="message-section">
            <div class="header-with-info">
                <h2>Envio de Mensagens</h2>
                <button id="infoButton" class="info-icon" title="Ajuda">‚ÑπÔ∏è</button>
            </div>



            <textarea id="numbers" placeholder="Separe os n√∫meros por v√≠rgula:
Para incluir nomes, use: Nome: n√∫mero (ex: Daniel: 8897000530). 
Se n√£o for usar nome, insira dois pontos antes do n√∫mero (ex: :8897000530). 
N√£o precisa v√≠rgula ap√≥s o √∫ltimo n√∫mero." required></textarea>

            <div id="fileInputArea" class="input-area">
                <input type="file" id="spreadsheet" accept=".xlsx, .xls, .csv" style="display: none;">
                <button onclick="document.getElementById('spreadsheet').click()" class="btn-upload">Escolher
                    Arquivo com Contatos</button>
                <p id="fileStatus" class="status-message">Nenhum arquivo selecionado.</p>
            </div>

            <div class=" message-box" id="messageBox">
                <div class="message-wrapper">
                    <textarea id="message" placeholder="Digite sua mensagem.
Use as vari√°veis: {nome}, {paciente}, {data}, {hora}.
Arraste uma imagem ou clique no clipe üìé" required></textarea>
                    <button type="button" id="uploadButton" class="clip-button">üìé</button>
                </div>
                <input type="file" id="imageInput" accept="image/*" hidden />

                <img id="previewImage" style="display: none;" alt="Preview da imagem" />
                <button type="button" id="removeImageButton" style="display: none; margin-top: 10px;">‚ùå Remover
                    imagem</button>
            </div>

            <button id="sendButton" onclick="sendMessage()" style=" min-width: 200px">Enviar Mensagem</button>
            <p id="status" class="status-message"></p>

        </div>
    </div>

    <footer>Daniel Holanda &copy; 2025</footer>
    <script src="script.js"></script>

    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span id="closeModal" class="close">&times;</span>
            <h3>Como utilizar o sistema de envio</h3>
            <div class="modal-scroll">

                <div class="step">
                    <h4><span class="step-icon">üîë</span> 1. Autentica√ß√£o</h4>
                    <ul>
                        <li>Insira sua <strong>matr√≠cula</strong> e clique em <strong>"Autenticar"</strong>.</li>
                        <li>Escaneie o QR Code que aparecer com o WhatsApp do seu celular.</li>
                    </ul>
                </div>

                <div class="step">
                    <h4><span class="step-icon">üë•</span> 2. Inserir Contatos</h4>
                    <p>
                        Voc√™ tem duas op√ß√µes. O sistema dar√° prioridade √† <strong>planilha</strong> se ambas as fontes
                        forem preenchidas.
                    </p>

                    <div class="sub-step">
                        <h5>Op√ß√£o A: Colar Texto</h5>
                        <p>Ideal para envios r√°pidos. Use o formato abaixo, com um contato por linha:</p>
                        <div class="code-example">
                            <code>Nome:Numero;Paciente;Data;Hora</code>
                            <code><strong>Ex:</strong> Daniel:88997000530;Pedro;05/09/2025;19h</code>
                        </div>
                    </div>

                    <div class="sub-step">
                        <h5>Op√ß√£o B: Carregar Planilha (.xlsx, .csv)</h5>
                        <p>Perfeito para listas grandes. A planilha <strong>n√£o deve ter cabe√ßalho</strong> (t√≠tulos) e
                            deve seguir a estrutura:</p>
                        <ul>
                            <li><strong>Coluna A:</strong> Nome do Contato</li>
                            <li><strong>Coluna B:</strong> N√∫mero do WhatsApp</li>
                            <li><strong>Coluna C:</strong> Nome do Paciente</li>
                            <li><strong>Coluna D:</strong> Data</li>
                            <li><strong>Coluna E:</strong> Hora</li>
                        </ul>
                    </div>
                </div>

                <div class="step">
                    <h4><span class="step-icon">‚úçÔ∏è</span> 3. Escrever a Mensagem</h4>
                    <p>Digite sua mensagem e use as vari√°veis abaixo para personalizar:</p>
                    <div class="code-example">
                        <code>{nome}</code> <code>{paciente}</code> <code>{data}</code> <code>{hora}</code>
                    </div>
                    <p><em>Exemplo de template:</em><br>
                        <code>Ol√°, {nome}. Lembrete da consulta de {paciente} no dia {data} √†s {hora}.</code>
                    </p>
                </div>

                <div class="step">
                    <h4><span class="step-icon">üñºÔ∏è</span> 4. Anexar Imagem (Opcional)</h4>
                    <ul>
                        <li>Clique no √≠cone de clipe üìé ou arraste uma imagem para a √°rea da mensagem.</li>
                        <li>A imagem ser√° enviada junto com o texto como legenda.</li>
                    </ul>
                </div>

                <div class="step">
                    <h4><span class="step-icon">üöÄ</span> 5. Enviar</h4>
                    <ul>
                        <li>Com tudo pronto, clique em <strong>"Enviar Mensagem"</strong> e acompanhe o status do
                            processo.</li>
                    </ul>
                </div>

            </div>
        </div>

</body>

</html>